<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>관리자 모드 - NICU wanted off</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .btn-admin { @apply px-4 py-2 bg-indigo-600 text-white rounded-lg shadow hover:bg-indigo-700 transition; }
    .cell-booked { @apply bg-red-100; }
    .cell-open   { @apply bg-green-100 cursor-pointer hover:bg-green-200; }
    .admin-added { @apply font-bold bg-yellow-200; }
  </style>
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen p-6">

  <h1 class="text-3xl font-bold mb-6">⚙️ 관리자 모드</h1>
  <button id="logoutAdmin" class="btn-admin mb-4">로그아웃</button>

  <div class="overflow-x-auto mb-6">
    <table class="w-full bg-white rounded-lg shadow text-center">
      <thead class="bg-indigo-100">
        <tr><th class="p-2">일</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>토</th></tr>
      </thead>
      <tbody id="adminCalendar" class="divide-y"></tbody>
    </table>
  </div>

  <div id="details" class="bg-white p-4 rounded-lg shadow max-w-lg mx-auto">
    <h2 id="detailDate" class="text-xl font-semibold mb-2">날짜 선택</h2>
    <ul id="detailList" class="space-y-2 mb-4"></ul>
    <button id="addDummy" class="btn-admin">임의 추가</button>
  </div>

  <script>
  window.addEventListener('DOMContentLoaded', () => {
    const getData = () => JSON.parse(localStorage.getItem('app_data')||'{}');
    const saveData = d => localStorage.setItem('app_data', JSON.stringify(d));
    const getAdminAdds = () => JSON.parse(localStorage.getItem('app_adminAdds')||'{}');
    const saveAdminAdds = d => localStorage.setItem('app_adminAdds', JSON.stringify(d));

    const adminCal   = document.getElementById('adminCalendar');
    const detailDate = document.getElementById('detailDate');
    const detailList = document.getElementById('detailList');
    const addDummy   = document.getElementById('addDummy');
    const logoutBtn  = document.getElementById('logoutAdmin');

    let cur = new Date(), selectedDate = '';

    logoutBtn.onclick = () => { localStorage.removeItem('app_current'); location.href='index.html'; };

    function renderCalendar() {
      adminCal.innerHTML='';
      const year=cur.getFullYear(), month=cur.getMonth();
      const first=new Date(year,month,1).getDay();
      const days=new Date(year,month+1,0).getDate();
      let row=document.createElement('tr');
      for(let i=0;i<first;i++)row.appendChild(document.createElement('td'));
      const data=getData(), adds=getAdminAdds();
      for(let d=1; d<=days; d++){
        if((first+d-1)%7===0&&d!==1){adminCal.appendChild(row);row=document.createElement('tr');}
        const ds=`${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
        const u=(data[ds]||[]).length, a=(adds[ds]||[]).length, tot=u+a;
        const td=document.createElement('td');
        td.className=tot>0?'cell-booked p-2':'cell-open p-2';
        td.textContent=d+(tot>0?` (${tot})`: '');
        td.onclick=()=>showDetails(ds);
